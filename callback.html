<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Connecting to QuickBooks...</title>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
           display: flex; align-items: center; justify-content: center;
           height: 100vh; margin: 0; background: #f5f6fa; color: #2c3e50; }
    .box { text-align: center; }
    .spinner { width: 40px; height: 40px; border: 4px solid #e0e0e0;
               border-top-color: #2980b9; border-radius: 50%;
               animation: spin 0.8s linear infinite; margin: 0 auto 16px; }
    @keyframes spin { to { transform: rotate(360deg); } }
    p { font-size: 1rem; color: #555; }
    .error { color: #c0392b; }
  </style>
</head>
<body>
  <div class="box">
    <div class="spinner"></div>
    <p id="msg">Completing QuickBooks authorization...</p>
  </div>
  <script>
    const params = new URLSearchParams(window.location.search);
    const code  = params.get('code');
    const state = params.get('state');
    const realmId = params.get('realmId');
    const error = params.get('error');

    if (error) {
      document.getElementById('msg').className = 'error';
      document.getElementById('msg').textContent = 'Authorization failed: ' + error;
    } else if (code && state) {
      const local = 'http://localhost:8080/callback/?code=' + encodeURIComponent(code)
                  + '&state=' + encodeURIComponent(state)
                  + (realmId ? '&realmId=' + encodeURIComponent(realmId) : '');
      window.location.href = local;
    } else {
      document.getElementById('msg').className = 'error';
      document.getElementById('msg').textContent = 'Missing authorization parameters.';
    }
  </script>
</body>
</html>
